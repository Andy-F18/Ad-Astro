<!DOCTYPE html>

<html>

<script>
	const queryString = window.location.search;
	const urlParams = new URLSearchParams(queryString);

	function readFile(file){
		var xmlHttp = new XMLHttpRequest();
	    xmlHttp.open( "GET", file, false ); // false for synchronous request
	    xmlHttp.send( null );
	    return xmlHttp.responseText;
	}
	header = readFile("https://raw.githubusercontent.com/Andy-F18/Andy-F18.github.io/main/elem/header.html");
	files = readFile(`https://raw.githubusercontent.com/Andy-F18/Andy-F18.github.io/main/Images/${urlParams.get('album')}.json`);

	image = {};
	for(f of files.split("\n\n")){
		obj = JSON.parse(f);
		if(obj.fileName == urlParams.get('img')){
			image = obj
		}
	}
	link = `https://andy-f18.github.io/image?album=${urlParams.get('album')}&img=${image.fileName}`
</script>

<head>
	<meta charset="utf-8">
	<script src="https://kit.fontawesome.com/985774d57b.js" crossorigin="anonymous"></script>
	<link href="https://fonts.googleapis.com/css?family=Oswald:400,700&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="css/menu_style.css">
	<link rel="stylesheet" href="css/image.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<title>Ad Astro</title>
</head>

<body>
	<script>
	    document.write(header);
	</script>

	<div class="container">
		<script>
			if(String(window.location).search("#") == -1){
				path = `./Images/${urlParams.get('album')}/${image.fileName}`
				document.write(`<img src="${path}">`);
			}else{
				path = `./Images/${urlParams.get('album')}/${String(window.location).split('#')[1]}`
				document.write(`<img src="${path}">`);
			}
		</script>

		<div class="linked">
			<script>
				if(image.linked != []){
					path = `./Images/${urlParams.get('album')}/${image.fileName}`
					document.write(`<img src="${path}" onclick="window.location='${link}#${image.fileName}';">`)
					for(i of image.linked){
						path = `./Images/${urlParams.get('album')}/${i}`
						document.write(`<img src="${path}" onclick="window.location='${link}#${i}';">`)
					}
				}
			</script>
		</div>

		<div class="info">
			<script>
				document.write(`<p><b><h2>${image.name}</h2></b></p>`);
				document.write(`<p>Date: ${image.date}</p>`);
			</script>
			
		</div>
		
	</div>

</body>
</html>
